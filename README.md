# ETL-–ø—Ä–æ—Ü–µ—Å—Å —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Yandex Cloud

## üìù –û–ø–∏—Å–∞–Ω–∏–µ

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é –ø–æ–ª–Ω–æ–≥–æ ETL-–ø—Ä–æ—Ü–µ—Å—Å–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –æ–±–ª–∞—á–Ω—ã—Ö —Å–µ—Ä–≤–∏—Å–æ–≤ **Yandex Cloud**, –≤–∫–ª—é—á–∞—è:
- Yandex DataTransfer
- Yandex Data Processing (Hadoop + Spark)
- Apache Airflow
- Apache Kafka
- DataLens –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏

---

## ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∑–∞–¥–∞–Ω–∏—è

### üîπ –ó–∞–¥–∞–Ω–∏–µ 1: –†–∞–±–æ—Ç–∞ —Å Yandex DataTransfer
- –°–æ–∑–¥–∞–Ω–∞ –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –≤ **Yandex DataBase (YDB)**.
- –°–æ–∑–¥–∞–Ω–∞ —Ç–∞–±–ª–∏—Ü–∞ `transactions_v2` —Å –ø–µ—Ä–≤–∏—á–Ω—ã–º –∫–ª—é—á–æ–º.
- –í—Å—Ç–∞–≤–ª–µ–Ω—ã —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ (15 —Å—Ç—Ä–æ–∫).
- –ù–∞—Å—Ç—Ä–æ–µ–Ω —Ç—Ä–∞–Ω—Å—Ñ–µ—Ä –∏–∑ YDB –≤ **Object Storage** (—Ñ–æ—Ä–º–∞—Ç ‚Äî CSV/Parquet).
- –í—Å–µ YQL-—Å–∫—Ä–∏–ø—Ç—ã —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ –ø–∞–ø–∫–µ `ydb/`.

### üîπ –ó–∞–¥–∞–Ω–∏–µ 2: –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö –≤ Yandex Data Processing —á–µ—Ä–µ–∑ Apache Airflow
- –ü–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω—ã `.csv`-—Ñ–∞–π–ª—ã —Å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è–º–∏.
- –ù–∞–ø–∏—Å–∞–Ω–æ PySpark-–∑–∞–¥–∞–Ω–∏–µ `process_transactions.py`:
  - –°—á–∏—Ç—ã–≤–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ Object Storage
  - –§–∏–ª—å—Ç—Ä—É–µ—Ç —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º `"success"`
  - –°–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ Parquet
- –°–æ–∑–¥–∞–Ω DAG `process_transactions_dag`:
  - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç PySpark –∑–∞–¥–∞–Ω–∏–µ –Ω–∞ YDP
  - –£–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ Apache Airflow

### üîπ –ó–∞–¥–∞–Ω–∏–µ 3: –ü–æ—Ç–æ–∫–æ–≤–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ Kafka + PySpark (**–µ—Å–ª–∏ –≤—ã–ø–æ–ª–Ω—è–ª–æ—Å—å**)
- –ù–∞—Å—Ç—Ä–æ–µ–Ω —Ç–æ–ø–∏–∫ Kafka
- –ù–∞–ø–∏—Å–∞–Ω–æ PySpark-–∑–∞–¥–∞–Ω–∏–µ –¥–ª—è –ø–æ—Ç–æ–∫–æ–≤–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω –∫–ª–∞—Å—Ç–µ—Ä YDP

### üîπ –ó–∞–¥–∞–Ω–∏–µ 4 (–¥–æ–ø): –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –≤ DataLens
- –ü–æ—Å—Ç—Ä–æ–µ–Ω—ã –¥–∞—à–±–æ—Ä–¥—ã –Ω–∞ –æ—Å–Ω–æ–≤–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

---

## üóÇÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
etl_exa/
‚îú‚îÄ‚îÄ task1/
‚îÇ   ‚îú‚îÄ‚îÄ create_table_transactions_v2.yql
‚îÇ   ‚îî‚îÄ‚îÄ insert_transactions_v2.yql
‚îú‚îÄ‚îÄ task2/
‚îÇ   ‚îî‚îÄ‚îÄ process_transactions.py
‚îú‚îÄ‚îÄ airflow/
‚îÇ   ‚îî‚îÄ‚îÄ process_transactions_dag.py
‚îú‚îÄ‚îÄ data/
‚îÇ   ‚îî‚îÄ‚îÄ transactions_01.csv
‚îî‚îÄ‚îÄ README.md
```

---

## ‚öôÔ∏è –ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

- Yandex DataTransfer
- Yandex Data Processing (Spark)
- Apache Airflow
- Apache Kafka
- YDB
- HiveQL / SparkSQL / YQL
- DataLens

---

## üìå –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

- –í—Å–µ —Ä–µ—Å—É—Ä—Å—ã —Ä–∞–∑–≤—ë—Ä–Ω—É—Ç—ã –≤ —Ä–∞–º–∫–∞—Ö –æ–¥–Ω–æ–≥–æ –∫–∞—Ç–∞–ª–æ–≥–∞ Yandex Cloud
- –£–∫–∞–∑–∞–Ω—ã —Å–µ—Ä–≤–∏—Å–Ω—ã–µ –∞–∫–∫–∞—É–Ω—Ç—ã —Å –Ω—É–∂–Ω—ã–º–∏ —Ä–æ–ª—è–º–∏ (`ydb.editor`, `datatransfer.agent`, `airflow.admin`)
- –í—Å–µ –∑–∞–¥–∞–Ω–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω—ã –≤ —Ä–∞–º–∫–∞—Ö –ª–∏–º–∏—Ç–æ–≤ –±–µ—Å–ø–ª–∞—Ç–Ω–æ–≥–æ —Ç–∞—Ä–∏—Ñ–∞
